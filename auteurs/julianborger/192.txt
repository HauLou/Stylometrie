The bargaining was on its third round and entering its fifth day. As midnight came and went, a deal on Iran's nuclear programme, which had eluded the world for a decade, drew maddeningly close. But as it did, the din from the party next door just got louder.
The negotiating session in Geneva had been due to last from Wednesday to Friday, but by Friday afternoon the schedule had been thrown out of the window. As in the previous round, the US secretary of state, The original plan had been to use Geneva's suitably imposing white landmark, the Palace of Nations, for the negotiations. That was, after all, what it had been built for in 1929 as the headquarters for the ill-fated League of Nations. It had bags of room and huge history-drenched chambers. But the delegates all preferred the five-star Intercontinental hotel, where they could go for a shower during coffee breaks and fall straight into bed in the early hours after a long night's nuclear horse-trading.
One of the drawbacks, however, was catering. In the Palace of Nations, huge buffets could be laid out. In the hotel, going down to dinner meant wading through a sea of journalists who had been starved of news for days, while ordering room service was lonely and offered no break from the luxurious claustrophobia of the hotel. In the end the different delegations improvised. The Iranians found an Iranian restaurant which made deliveries. The British and the Americans each found a recommended pizza restaurant and headed out separately only to find they had independently chosen the same place. A greater challenge was that when the negotiations inevitably spilled into the weekend, the Intercontinental was double-booked. On one wing of the first floor were the committee rooms set aside for the talks, but the rest was hired out for parties.
On the Saturday night a charity ball was held, the organisers of which decorated the hallway with a full-size hot-air balloon gondola, and hired a country-folk band who became more raucous as the evening wore on. As midnight passed and it was genuinely unclear whether the high-level political capital being spent would pay off or collapse under its own weight, the focus of the diplomats poring over heavy-water reactor designs was constantly assaulted by the strains of Loch Lomond and Ring of Fire.
At times the two sets of guests became enmeshed. When the Russian foreign minister, Sergey Lavrov, and his team would make their way in and out of the hotel he had the Swiss security guards clear all the journalists from the central lobby and even warned them not to shout questions on pain of eviction. When Lavrov strolled through, the guards shushed loudly, silencing journalists - but not the other paying guests. As the night drew on and they became tipsier, they were drawn to the polished stone lobby in their dinner jackets as if it were a red carpet at the Oscars. Long ball-gowns and stiletto heels, intermingling with the business suits of the foreign ministry teams, sometimes created a human logjam at the glass revolving door.
Against this Fellini-like backdrop, a tense game of diplomatic bluff was being played out on the first floor. Officials who were in the room in the last few hours of negotiations insist that the outcome was unclear at the 11th hour.
"It was touch and go until the end," one said. "All the pieces of the puzzle were there but the hard part was to get them to line up with political will."
Ashton had tried several different negotiating formats but in the endgame, the one that seemed to work involved keeping the foreign ministers from the six-nation group (known confusingly as both the E3+3 and the P5+1) in one room where they could debate what tweaks to the language to the draft text were collectively acceptable. Those tweaks would be transmitted by hand from Ashton's aides to the suite of rooms a dozen floors up where the Iranian foreign minister, Mohammad Javad Zarif, was installed.
As Saturday turned to Sunday, the final decisions were taken by capitals, particularly Washington, as Kerry excused himself on several occasions to call the White House. Until the last moment, one diplomat recalls, small changes in language were being typed straight into the draft.
By then, at about 2am, news of impending success had leaked to an Iranian news agency, and it had to be angrily denied to ensure that it would ultimately be proved right. Then at 3am Geneva time almost exactly, Ashton's spokesman, Michael Mann, pressed the button on a tweet baldly stating a string of words some had beginning to doubt would ever been used: "We have reached agreement between E3+3 and 